<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <div id="front-page">
    <h1>start</h1>
    <div class="before-result"></div>
    <ul class="front-page__btns"></ul>
  </div>

  <script src="./data.js"></script>
  <script>
  const setCookie = (name,value,m) => {
    var date = new Date();
    date.setTime(date.getTime() + m * 60 * 1000);
    document.cookie = name + "=" + encodeURI(value) +  ';expires=' + date.toUTCString() + ';path=/';
  }

  //쿠키 삭제
  const delCookie = (Name) => {
    var expireDate = new Date();
    expireDate.setDate(expireDate.getDate() - 1);
    document.cookie = Name + "= " + "; expires=" + expireDate.toGMTString() + "; path=/";
  }

  //쿠키 가져오기
  const getCookie = (name) => {
    var x, y;
    var val = document.cookie.split(';');
    for (var i = 0; i < val.length; i++) {
        x = val[i].substr(0, val[i].indexOf('='));
        y = val[i].substr(val[i].indexOf('=') + 1);
        x = x.replace(/^\s+|\s+$/g, '');
        if (x == name) {
            return unescape(y);
        }
    }
  }


   //시작 페이지 버튼 생성
  const createStartBtn = (btnBox,resultBox) => {
    var html = "";

    var page = location.protocol +"/"+ location.hostname.replace(/\/index.html/ig,"")
      if(getCookie(COOKIE_OPTION.history.name)){
        //html += `<li><a href=${page + "/test.html?state=true"} >진행중인 검사 이어하기</a></li>`
        html += `<li><a href=${"/test.html"} >진행중인 검사 이어하기</a></li>`
      } 
      if (getCookie(COOKIE_OPTION.result.name)) {
        var resultType = getCookie(COOKIE_OPTION.result.name);
        var path = '/result.html/type?=' + resultType;
        var resultImg = `<a><img src=${QUESTION_TYPE_IMAGE[resultType].toUpperCase()}/></a>`
        html += `<li><a href=${'/result.html?type=' + resultType}>${getCookie(COOKIE_OPTION.result.name)}타입 관련상품 보러가기</a></li>`

        //html += `<li><a href=${page + path}>${getCookie('resulttype')}타입 관련상품 보러가기</a></li>`
        resultBox.insertAdjacentHTML('beforeend',resultImg)
      }

      //html += `<li><a href=${page + "/test.html?state=false"}>새롭게 진행하기</a></li>`
      html += `<li class="new-test"><a href="javascript:void(0)">새롭게 진행하기</a></li>`

      btnBox.insertAdjacentHTML('beforeend',html);


      document.querySelector('.new-test').addEventListener('click',()=>{
        delCookie(COOKIE_OPTION.history.name)
        delCookie(COOKIE_OPTION.result.name)
        location.href = '/test.html'
      }) 

  }
  createStartBtn(document.querySelector('.front-page__btns'),document.querySelector('.before-result'))



  </script>
</body>
</html>